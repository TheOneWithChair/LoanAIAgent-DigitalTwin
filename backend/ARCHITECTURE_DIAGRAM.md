# ğŸ—ï¸ LOAN API ARCHITECTURE DIAGRAM

## ğŸ“Š System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React/Next.js)                     â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Loan Application    â”‚         â”‚  Application Details   â”‚         â”‚
â”‚  â”‚ Form Component      â”‚         â”‚  View Component        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚             â”‚                               â”‚                        â”‚
â”‚             â”‚ POST /loan-applications       â”‚ GET /loan-applications â”‚
â”‚             â”‚                               â”‚     /{uuid}            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FASTAPI BACKEND                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                    API ENDPOINTS                           â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  POST /loan-applications                                   â”‚      â”‚
â”‚  â”‚  â”œâ”€ Validate input (Pydantic)                             â”‚      â”‚
â”‚  â”‚  â”œâ”€ Create LoanApplication                                â”‚      â”‚
â”‚  â”‚  â”œâ”€ Run 4 AI Agents                                       â”‚      â”‚
â”‚  â”‚  â”œâ”€ Save AgentResponses                                   â”‚      â”‚
â”‚  â”‚  â”œâ”€ Save AnalyticsSnapshot                                â”‚      â”‚
â”‚  â”‚  â””â”€ Return complete response                              â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  GET /loan-applications/{uuid}                            â”‚      â”‚
â”‚  â”‚  â”œâ”€ Validate UUID                                         â”‚      â”‚
â”‚  â”‚  â”œâ”€ Fetch with prefetch_related                          â”‚      â”‚
â”‚  â”‚  â””â”€ Return all data                                       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                    AI AGENT LAYER                          â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚      â”‚
â”‚  â”‚  â”‚ Credit Scoring  â”‚  â”‚ Risk Assessment â”‚                â”‚      â”‚
â”‚  â”‚  â”‚ Agent           â”‚  â”‚ Agent           â”‚                â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚      â”‚
â”‚  â”‚  â”‚ Verification    â”‚  â”‚ Decision Engine â”‚                â”‚      â”‚
â”‚  â”‚  â”‚ Agent           â”‚  â”‚ Agent           â”‚                â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                  TORTOISE ORM LAYER                        â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”‚
â”‚  â”‚  â”‚          LoanApplication Model                   â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  - UUID Primary Key                              â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  - Applicant Info (name, email, phone)          â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  - Loan Details (amount, purpose, tenure)       â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  - Financial Info (income, employment, credit)  â”‚      â”‚      â”‚
â”‚  â”‚  â”‚  - Decision (final_decision, approved_amount)   â”‚      â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â”‚
â”‚  â”‚         â”‚                           â”‚                      â”‚      â”‚
â”‚  â”‚         â”‚ One-to-Many              â”‚ One-to-One          â”‚      â”‚
â”‚  â”‚         â–¼                           â–¼                      â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚      â”‚
â”‚  â”‚  â”‚ AgentResponse   â”‚        â”‚ AnalyticsSnapshotâ”‚         â”‚      â”‚
â”‚  â”‚  â”‚ - UUID PK       â”‚        â”‚ - UUID PK        â”‚         â”‚      â”‚
â”‚  â”‚  â”‚ - ForeignKey    â”‚        â”‚ - OneToOne Field â”‚         â”‚      â”‚
â”‚  â”‚  â”‚ - agent_type    â”‚        â”‚ - credit_score   â”‚         â”‚      â”‚
â”‚  â”‚  â”‚ - response_data â”‚        â”‚ - risk_score     â”‚         â”‚      â”‚
â”‚  â”‚  â”‚ - confidence    â”‚        â”‚ - DTI ratio      â”‚         â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATABASE LAYER                               â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ loan_applications  â”‚  â”‚ agent_responses â”‚  â”‚ analytics_      â”‚  â”‚
â”‚  â”‚ table              â”‚  â”‚ table           â”‚  â”‚ snapshots table â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚
â”‚  â”‚ id (UUID) PK       â”‚  â”‚ id (UUID) PK    â”‚  â”‚ id (UUID) PK    â”‚  â”‚
â”‚  â”‚ applicant_id       â”‚â—„â”€â”¤ loan_app_id FK  â”‚  â”‚ loan_app_id FK  â”‚  â”‚
â”‚  â”‚ full_name          â”‚  â”‚ agent_type      â”‚  â”‚ credit_score    â”‚  â”‚
â”‚  â”‚ loan_amount        â”‚  â”‚ response_data   â”‚  â”‚ risk_score      â”‚  â”‚
â”‚  â”‚ final_decision     â”‚  â”‚ confidence      â”‚  â”‚ dti_ratio       â”‚  â”‚
â”‚  â”‚ created_at         â”‚  â”‚ created_at      â”‚  â”‚ created_at      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                       â”‚
â”‚  SQLite (Dev) / PostgreSQL (Prod) / MySQL                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request Flow Diagram

### POST /loan-applications Flow

```
Frontend                    Backend                     Database
   â”‚                           â”‚                            â”‚
   â”‚â”€â”€â”€ POST request â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
   â”‚    (JSON payload)          â”‚                            â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  1. Validate   â”‚                  â”‚
   â”‚                    â”‚     (Pydantic) â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  2. Create     â”‚â”€â”€â”€â”€â”€ INSERT â”€â”€â”€â”€>â”‚
   â”‚                    â”‚  LoanApp       â”‚                  â”‚
   â”‚                    â”‚  (UUID gen)    â”‚<â”€â”€â”€â”€ UUID â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  3. Credit     â”‚                  â”‚
   â”‚                    â”‚     Scoring    â”‚                  â”‚
   â”‚                    â”‚     Agent      â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ INSERT AgentResp â”€â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  4. Risk       â”‚                  â”‚
   â”‚                    â”‚     Assessment â”‚                  â”‚
   â”‚                    â”‚     Agent      â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ INSERT AgentResp â”€â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  5. Verification                  â”‚
   â”‚                    â”‚     Agent      â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ INSERT AgentResp â”€â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  6. Decision   â”‚                  â”‚
   â”‚                    â”‚     Engine     â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ INSERT AgentResp â”€â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  7. Create     â”‚                  â”‚
   â”‚                    â”‚     Analytics  â”‚                  â”‚
   â”‚                    â”‚     Snapshot   â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ INSERT Analytics â”€â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  8. Update     â”‚                  â”‚
   â”‚                    â”‚     LoanApp    â”‚                  â”‚
   â”‚                    â”‚     Status     â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ UPDATE LoanApp â”€â”€â”€â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  9. Prefetch   â”‚                  â”‚
   â”‚                    â”‚     Relations  â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ SELECT with JOINs â”€â”€>â”‚
   â”‚                            â”‚<â”€â”€â”€â”€ All related data â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚ 10. Build      â”‚                  â”‚
   â”‚                    â”‚     Response   â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚<â”€â”€â”€ 201 Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
   â”‚    (Complete data)         â”‚                            â”‚
   â”‚    - application_id        â”‚                            â”‚
   â”‚    - agent_responses       â”‚                            â”‚
   â”‚    - analytics_snapshot    â”‚                            â”‚
   â”‚                            â”‚                            â”‚
```

### GET /loan-applications/{uuid} Flow

```
Frontend                    Backend                     Database
   â”‚                           â”‚                            â”‚
   â”‚â”€â”€â”€ GET request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
   â”‚    (/loan-applications/   â”‚                            â”‚
   â”‚     {uuid})                â”‚                            â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  1. Validate   â”‚                  â”‚
   â”‚                    â”‚     UUID       â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚  (If invalid UUID)         â”‚
   â”‚<â”€â”€â”€ 400 Bad Request â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  2. Query DB   â”‚                  â”‚
   â”‚                    â”‚     with       â”‚                  â”‚
   â”‚                    â”‚     prefetch   â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚â”€â”€â”€â”€â”€ SELECT with JOINs â”€â”€>â”‚
   â”‚                            â”‚      (loan_applications   â”‚
   â”‚                            â”‚       agent_responses     â”‚
   â”‚                            â”‚       analytics_snapshots)â”‚
   â”‚                            â”‚<â”€â”€â”€â”€ All data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                            â”‚                            â”‚
   â”‚                            â”‚  (If not found)            â”‚
   â”‚<â”€â”€â”€ 404 Not Found â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
   â”‚                            â”‚                            â”‚
   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
   â”‚                    â”‚  3. Build      â”‚                  â”‚
   â”‚                    â”‚     Response   â”‚                  â”‚
   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
   â”‚                            â”‚                            â”‚
   â”‚<â”€â”€â”€ 200 OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
   â”‚    (Complete data)         â”‚                            â”‚
   â”‚    - loan_application      â”‚                            â”‚
   â”‚    - agent_responses[]     â”‚                            â”‚
   â”‚    - analytics_snapshot    â”‚                            â”‚
   â”‚                            â”‚                            â”‚
```

---

## ğŸ—‚ï¸ Database Schema Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    loan_applications                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    UUID (PK)                              â”‚
â”‚ applicant_id          VARCHAR(100) INDEX                     â”‚
â”‚ full_name             VARCHAR(255)                           â”‚
â”‚ email                 VARCHAR(255) INDEX                     â”‚
â”‚ phone_number          VARCHAR(50)                            â”‚
â”‚ date_of_birth         DATE                                   â”‚
â”‚ address               TEXT                                   â”‚
â”‚ loan_amount_requested DECIMAL(15,2)                          â”‚
â”‚ loan_purpose          VARCHAR(100)                           â”‚
â”‚ loan_tenure_months    INTEGER                                â”‚
â”‚ credit_score          INTEGER                                â”‚
â”‚ monthly_income        DECIMAL(15,2)                          â”‚
â”‚ employment_status     VARCHAR(50)                            â”‚
â”‚ employment_duration   INTEGER                                â”‚
â”‚ status                ENUM (submitted, processing, ...)      â”‚
â”‚ final_decision        VARCHAR(50)                            â”‚
â”‚ approved_amount       DECIMAL(15,2)                          â”‚
â”‚ interest_rate         FLOAT                                  â”‚
â”‚ additional_data       JSON                                   â”‚
â”‚ created_at            TIMESTAMP                              â”‚
â”‚ updated_at            TIMESTAMP                              â”‚
â”‚ processed_at          TIMESTAMP                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                         â”‚
         â”‚ One-to-Many            â”‚ One-to-One
         â”‚ CASCADE                â”‚ CASCADE
         â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   agent_responses       â”‚  â”‚  analytics_snapshots     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id            UUID (PK) â”‚  â”‚ id            UUID (PK)  â”‚
â”‚ loan_app_id   UUID (FK)â”€â”¼â”€>â”‚ loan_app_id   UUID (FK)  â”‚
â”‚               INDEX      â”‚  â”‚               UNIQUE     â”‚
â”‚ agent_type    ENUM      â”‚  â”‚ calc_credit_score  INT   â”‚
â”‚ agent_name    VARCHAR   â”‚  â”‚ risk_score         FLOAT â”‚
â”‚ agent_version VARCHAR   â”‚  â”‚ approval_prob      FLOAT â”‚
â”‚ response_data JSON      â”‚  â”‚ recommended_amt    DEC   â”‚
â”‚ confidence    FLOAT     â”‚  â”‚ recommend_rate     FLOAT â”‚
â”‚ exec_time_ms  INTEGER   â”‚  â”‚ dti_ratio          FLOAT â”‚
â”‚ status        VARCHAR   â”‚  â”‚ lti_ratio          FLOAT â”‚
â”‚ error_message TEXT      â”‚  â”‚ risk_factors       JSON  â”‚
â”‚ created_at    TIMESTAMP â”‚  â”‚ positive_factors   JSON  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ model_scores       JSON  â”‚
                              â”‚ processing_time    FLOAT â”‚
                              â”‚ total_agents       INT   â”‚
                              â”‚ created_at         TS    â”‚
                              â”‚ updated_at         TS    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Relationship Diagram

```
                    LoanApplication
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ id: UUID    â”‚
                    â”‚ (PK)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                         â”‚
              â”‚ One-to-Many            â”‚ One-to-One
              â”‚ (related_name:         â”‚ (related_name:
              â”‚  "agent_responses")    â”‚  "analytics_snapshot")
              â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ AgentResponse    â”‚      â”‚ AnalyticsSnapshot   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ id: UUID (PK)    â”‚      â”‚ id: UUID (PK)       â”‚
    â”‚ loan_app: FK     â”‚      â”‚ loan_app: OneToOne  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚  â”‚  â”‚  â”‚
         â”‚  â”‚  â”‚  â””â”€ Decision Engine Agent
         â”‚  â”‚  â””â”€â”€â”€â”€ Verification Agent
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€ Risk Assessment Agent
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Credit Scoring Agent
```

### Accessing Relationships

```python
# Forward (from child to parent)
agent = await AgentResponse.get(id=uuid)
application = await agent.loan_application

analytics = await AnalyticsSnapshot.get(id=uuid)
application = await analytics.loan_application

# Reverse (from parent to children)
app = await LoanApplication.get(id=uuid).prefetch_related(
    "agent_responses",      # List of AgentResponse objects
    "analytics_snapshot"    # Single AnalyticsSnapshot object
)

# Access prefetched data
for agent in app.agent_responses:
    print(agent.agent_name)

print(app.analytics_snapshot.risk_score)
```

---

## ğŸ¯ Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRONTEND LAYER                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP/JSON
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASTAPI LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Endpoints (main.py)                                   â”‚   â”‚
â”‚  â”‚  - POST /loan-applications                            â”‚   â”‚
â”‚  â”‚  - GET /loan-applications/{uuid}                      â”‚   â”‚
â”‚  â”‚  - GET /health                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                 â”‚
â”‚                            â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Pydantic Schemas (validation)                         â”‚   â”‚
â”‚  â”‚  - LoanApplicationCreate                              â”‚   â”‚
â”‚  â”‚  - LoanApplicationResponse                            â”‚   â”‚
â”‚  â”‚  - AgentResponseOut                                   â”‚   â”‚
â”‚  â”‚  - AnalyticsSnapshotOut                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                 â”‚
â”‚                            â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Business Logic / AI Agents                            â”‚   â”‚
â”‚  â”‚  - simulate_credit_scoring_agent()                    â”‚   â”‚
â”‚  â”‚  - simulate_risk_assessment_agent()                   â”‚   â”‚
â”‚  â”‚  - simulate_verification_agent()                      â”‚   â”‚
â”‚  â”‚  - simulate_decision_engine_agent()                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ async/await
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TORTOISE ORM LAYER                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Models (ORM)                                          â”‚   â”‚
â”‚  â”‚  - LoanApplication                                    â”‚   â”‚
â”‚  â”‚  - AgentResponse                                      â”‚   â”‚
â”‚  â”‚  - AnalyticsSnapshot                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Operations                                            â”‚   â”‚
â”‚  â”‚  - .create()                                          â”‚   â”‚
â”‚  â”‚  - .get()                                             â”‚   â”‚
â”‚  â”‚  - .prefetch_related()                                â”‚   â”‚
â”‚  â”‚  - .save()                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ SQL Queries
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE LAYER                            â”‚
â”‚  SQLite (Development)                                        â”‚
â”‚  PostgreSQL (Production)                                     â”‚
â”‚  MySQL (Alternative)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Visualization

### POST Request Data Transformation

```
Frontend Input
    â†“
{
  "full_name": "Jane Smith",
  "loan_amount_requested": 50000,
  "monthly_income": 6500,
  ...
}
    â†“
Pydantic Validation (LoanApplicationCreate)
    â†“
Tortoise ORM Model (LoanApplication)
    â†“
Database Record (loan_applications table)
    id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
    full_name: "Jane Smith"
    ...
    â†“
AI Agents Process Data
    â†“
Multiple AgentResponse Records Created
    â†“
AnalyticsSnapshot Record Created
    â†“
LoanApplication Updated with Decision
    â†“
Prefetch All Relationships
    â†“
Pydantic Response Models
    â†“
JSON Response to Frontend
    â†“
{
  "application_id": "f47ac10b-...",
  "loan_application": {...},
  "agent_responses": [...],
  "analytics_snapshot": {...}
}
```

---

## ğŸ”„ State Transitions

```
Application Status Flow:

SUBMITTED â”€â”€â”€â”€â”€â”€> PROCESSING â”€â”€â”€â”€â”€â”€> COMPLETED
    â”‚                                    â”‚
    â”‚                                    â”œâ”€> APPROVED
    â”‚                                    â”œâ”€> REJECTED
    â”‚                                    â””â”€> PENDING_REVIEW
    â”‚
    â””â”€â”€> (validation error) â”€â”€> FAILED
```

---

This architecture provides:
- âœ… Clear separation of concerns
- âœ… Async processing throughout
- âœ… Proper relationship management
- âœ… Type safety with Pydantic
- âœ… Efficient data fetching with prefetch
- âœ… Scalable design for production use
